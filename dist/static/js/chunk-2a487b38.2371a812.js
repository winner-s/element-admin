(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a487b38"],{"0c11":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("薪资代发导入")])]),a("div",[a("div",{staticClass:"text"},[a("a",[e._v("下载模板")]),a("p",[e._v("提示：选择文件前，请先下载模板;点击导入才能导入成功")])]),a("div",{staticClass:"bto"},[a("upload-excel",{attrs:{"import-text":"选择文件","on-success":e.generateData}}),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:e.add}},[e._v("导入")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",size:"mini"}},[a("el-table-column",{attrs:{align:"center",width:"50",type:"index"}}),e._l(e.tabHeader,(function(e){return a("el-table-column",{key:e,attrs:{prop:e,align:"center",label:e}})}))],2)],1)])],1)},s=[],i=a("3796"),r={components:{UploadExcel:i["a"]},data:function(){return{dataList:[],tabHeader:["工号","收款方账号","收款方账户名称","开户行名称","开户行类型","开户行(省)","开户行(市)","币种","支付类型"]}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{generateData:function(e){var t=e.header,a=e.results;this.tabHeader=t,this.dataList=a},add:function(){var e=this;0===this.dataList.length?this.$confirm("请选择导入文件","提示",{confirmButtonText:"确定",type:"warning",showCancelButton:!1}):this.$confirm("您确认导入嘛？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"导入成功!"}),e.dataList=[]})).catch((function(){e.$message({type:"info",message:"已取消导入"})}))}}},c=r,l=(a("ee78"),a("2877")),o=Object(l["a"])(c,n,s,!1,null,"3cc15e39",null);t["default"]=o.exports},1:function(e,t){},2:function(e,t){},3:function(e,t){},3796:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"import-span"},[a("input",{ref:"fileExcel",staticClass:"upFile",attrs:{type:"file",accept:".xls"},on:{change:e.uploadFile}}),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleClick}},[e._v(e._s(e.importText))])],1)},s=[],i=(a("d3b7"),a("1146")),r=a.n(i),c={props:{breforeUpload:Function,onSuccess:Function,importText:{type:String,default:"导入"}},data:function(){return{excelList:{header:null,results:null}}},methods:{handleClick:function(){this.$refs.fileExcel.click()},generateData:function(e){var t=e.header,a=e.results;this.excelList.header=t,this.excelList.results=a,this.onSuccess&&this.onSuccess(this.excelList)},uploadFile:function(e){var t=e.target.files[0];this.$refs.fileExcel.value=null,this.readData(t)},readData:function(e){var t=this;return new Promise((function(a){var n=new FileReader;n.onload=function(e){var n=e.target.result,s=r.a.read(n,{type:"array"}),i=s.SheetNames[0],c=s.Sheets[i],l=t.getHeaderRow(c),o=r.a.utils.sheet_to_json(c);t.generateData({header:l,results:o}),a()},n.readAsArrayBuffer(e)}))},getHeaderRow:function(e){var t,a=[],n=r.a.utils.decode_range(e["!ref"]),s=n.s.r;for(t=n.s.c;t<=n.e.c;++t){var i=e[r.a.utils.encode_cell({c:t,r:s})],c="UNKNOWN "+t;i&&i.t&&(c=r.a.utils.format_cell(i)),a.push(c)}return a}}},l=c,o=(a("500d"),a("2877")),u=Object(o["a"])(l,n,s,!1,null,"c9085c52",null);t["a"]=u.exports},"500d":function(e,t,a){"use strict";a("fbee")},ee78:function(e,t,a){"use strict";a("ffe3")},fbee:function(e,t,a){},ffe3:function(e,t,a){}}]);